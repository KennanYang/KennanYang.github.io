---
title: MCPå®æˆ˜ï¼šä»é›¶å¼€å§‹æ„å»ºè´¢åŠ¡æŠ¥å‘Šç”Ÿæˆå·¥å…·
date: 2025-07-31 20:00:00
categories: AIå¼€å‘
tags:
  - MCP
  - è´¢åŠ¡æŠ¥å‘Š
  - AIå·¥å…·
  - è‡ªåŠ¨åŒ–
  - æŠ€æœ¯å®æˆ˜
abbrlink: financial-report-generator
cover: /images/kennanAi.png
---

## ğŸš€ å‰è¨€

Model Context Protocol (MCP) æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œå…è®¸AIæ¨¡å‹ä¸å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºè¿›è¡Œå®‰å…¨ã€ç»“æ„åŒ–çš„äº¤äº’ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªåŸºäºMCPçš„è´¢åŠ¡æŠ¥å‘Šç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡å®é™…é¡¹ç›®å±•ç¤ºMCPçš„æ¥å…¥æµç¨‹å’Œæ ¸å¿ƒæ¦‚å¿µã€‚

> æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ã€Œæºå—AIå®æˆ˜æ´¾ã€ï¼Œå…³æ³¨è·å–æ›´å¤šAIå®æˆ˜æŠ€æœ¯åˆ†äº«

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„MCPæœåŠ¡å™¨ï¼Œæä¾›äº¤äº’å¼å…¬å¸è´¢æŠ¥ç”ŸæˆåŠŸèƒ½ã€‚é¡¹ç›®æ”¯æŒ10å®¶çŸ¥åå…¬å¸ï¼ˆå¦‚NVIDIAã€Appleã€Microsoftç­‰ï¼‰ï¼Œèƒ½å¤Ÿç”ŸæˆåŒ…å«è´¢åŠ¡æ•°æ®ã€ä¸šåŠ¡åˆ†æã€é£é™©è¯„ä¼°ç­‰å†…å®¹çš„è¯¦ç»†è´¢æŠ¥ã€‚

**é¡¹ç›®æºç **: [https://github.com/KennanYang/financial-report](https://github.com/KennanYang/financial-report)

---

## ğŸ’¡ MCPæ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯MCPï¼Ÿ

MCPï¼ˆModel Context Protocolï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œå®šä¹‰äº†AIæ¨¡å‹ä¸å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºäº¤äº’çš„æ ‡å‡†æ–¹å¼ã€‚å®ƒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š

1. **Toolsï¼ˆå·¥å…·ï¼‰**: å¯è°ƒç”¨çš„å‡½æ•°ï¼Œå…·æœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡º
2. **Resourcesï¼ˆèµ„æºï¼‰**: å¯è¯»å–çš„æ•°æ®æˆ–æ–‡ä»¶ï¼Œå…·æœ‰URIæ ¼å¼

### MCPæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    MCP Protocol    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Model  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ MCP Server  â”‚
â”‚  (Client)   â”‚                    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   Tools &   â”‚
                                    â”‚ Resources   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ å®æˆ˜ï¼šæ„å»ºMCPè´¢åŠ¡æŠ¥å‘Šå·¥å…·

### ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡

é¦–å…ˆå®‰è£…å¿…è¦çš„ä¾èµ–ï¼š

```bash
pip install mcp pydantic asyncio
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºMCPå·¥å…·

æˆ‘ä»¬ä»¥å…¬å¸è´¢æŠ¥ç”Ÿæˆå·¥å…·ä¸ºä¾‹ï¼Œå±•ç¤ºMCPå·¥å…·çš„å®ç°ï¼š

```python
# src/mcp_server/tools/company_report_generator.py

import asyncio
import logging
from datetime import datetime
from pathlib import Path
from typing import Any, Dict, List

from mcp.types import (
    CallToolRequest,
    CallToolResult,
    ListToolsRequest,
    ListToolsResult,
    TextContent,
    Tool,
)

class CompanyReportGenerator:
    """å…¬å¸è´¢æŠ¥ç”Ÿæˆå·¥å…·"""
    
    def __init__(self):
        self.logger = logging.getLogger(__name__)
        self.output_dir = Path("output")
        self.output_dir.mkdir(exist_ok=True)
        
        # é¢„å®šä¹‰çš„å…¬å¸åˆ—è¡¨
        self.companies = {
            "NVDA": {"name": "NVIDIA Corporation", "sector": "Technology", "industry": "Semiconductors"},
            "AAPL": {"name": "Apple Inc.", "sector": "Technology", "industry": "Consumer Electronics"},
            "MSFT": {"name": "Microsoft Corporation", "sector": "Technology", "industry": "Software"},
            # ... æ›´å¤šå…¬å¸
        }
    
    async def list_tools(self, request: ListToolsRequest) -> ListToolsResult:
        """åˆ—å‡ºå¯ç”¨çš„MCPå·¥å…·"""
        tools = [
            Tool(
                name="list_companies",
                description="åˆ—å‡ºå¯ç”¨çš„å…¬å¸åˆ—è¡¨",
                inputSchema={
                    "type": "object",
                    "properties": {},
                    "required": []
                }
            ),
            Tool(
                name="generate_company_report",
                description="ç”ŸæˆæŒ‡å®šå…¬å¸çš„è´¢åŠ¡æŠ¥å‘Š",
                inputSchema={
                    "type": "object",
                    "properties": {
                        "symbol": {
                            "type": "string",
                            "description": "å…¬å¸è‚¡ç¥¨ä»£ç "
                        },
                        "report_type": {
                            "type": "string",
                            "enum": ["annual", "quarterly"],
                            "description": "æŠ¥å‘Šç±»å‹"
                        }
                    },
                    "required": ["symbol"]
                }
            )
        ]
        return ListToolsResult(tools=tools)
```

### ç¬¬ä¸‰æ­¥ï¼šå®ç°å·¥å…·åŠŸèƒ½

```python
async def call_tool(self, request: CallToolRequest) -> CallToolResult:
    """è°ƒç”¨MCPå·¥å…·"""
    if request.name == "list_companies":
        return await self._list_companies()
    elif request.name == "generate_company_report":
        return await self._generate_company_report(request.arguments)
    else:
        raise ValueError(f"Unknown tool: {request.name}")

async def _list_companies(self) -> CallToolResult:
    """åˆ—å‡ºå¯ç”¨å…¬å¸"""
    companies_list = []
    for symbol, info in self.companies.items():
        companies_list.append(f"{symbol}: {info['name']} ({info['sector']})")
    
    content = "å¯ç”¨å…¬å¸åˆ—è¡¨ï¼š\n" + "\n".join(companies_list)
    return CallToolResult(
        content=[TextContent(type="text", text=content)]
    )

async def _generate_company_report(self, arguments: Dict[str, Any]) -> CallToolResult:
    """ç”Ÿæˆå…¬å¸è´¢æŠ¥"""
    symbol = arguments.get("symbol", "").upper()
    report_type = arguments.get("report_type", "annual")
    
    if symbol not in self.companies:
        return CallToolResult(
            content=[TextContent(type="text", text=f"é”™è¯¯ï¼šæœªæ‰¾åˆ°å…¬å¸ {symbol}")]
        )
    
    company_info = self.companies[symbol]
    
    # ç”Ÿæˆè´¢æŠ¥å†…å®¹
    report_content = f"""
# {company_info['name']} ({symbol}) è´¢åŠ¡æŠ¥å‘Š

## å…¬å¸æ¦‚å†µ
- **è¡Œä¸š**: {company_info['industry']}
- **æ¿å—**: {company_info['sector']}
- **æŠ¥å‘Šç±»å‹**: {report_type}
- **ç”Ÿæˆæ—¶é—´**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

## è´¢åŠ¡æ‘˜è¦
[æ­¤å¤„åŒ…å«è´¢åŠ¡æ•°æ®å’Œåˆ†æ]

## ä¸šåŠ¡åˆ†æ
[æ­¤å¤„åŒ…å«ä¸šåŠ¡å‘å±•åˆ†æ]

## é£é™©è¯„ä¼°
[æ­¤å¤„åŒ…å«é£é™©è¯„ä¼°å†…å®¹]

## æŠ•èµ„å»ºè®®
[æ­¤å¤„åŒ…å«æŠ•èµ„å»ºè®®]
"""
    
    # ä¿å­˜æŠ¥å‘Šæ–‡ä»¶
    filename = f"{symbol}_{report_type}_report_{datetime.now().strftime('%Y%m%d_%H%M%S')}.md"
    filepath = self.output_dir / filename
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(report_content)
    
    return CallToolResult(
        content=[TextContent(type="text", text=f"æŠ¥å‘Šå·²ç”Ÿæˆï¼š{filepath}\n\n{report_content}")]
    )
```

### ç¬¬å››æ­¥ï¼šåˆ›å»ºMCPæœåŠ¡å™¨

```python
# src/mcp_server/main.py

import asyncio
import logging
from pathlib import Path

from mcp.server import Server
from mcp.server.stdio import stdio_server

from .tools.company_report_generator import CompanyReportGenerator

async def main():
    # é…ç½®æ—¥å¿—
    logging.basicConfig(level=logging.INFO)
    logger = logging.getLogger(__name__)
    
    # åˆ›å»ºMCPæœåŠ¡å™¨
    server = Server("financial-report-generator")
    
    # æ³¨å†Œå·¥å…·
    report_generator = CompanyReportGenerator()
    server.list_tools(report_generator.list_tools)
    server.call_tool(report_generator.call_tool)
    
    # å¯åŠ¨æœåŠ¡å™¨
    async with stdio_server() as (read_stream, write_stream):
        await server.run(
            read_stream,
            write_stream,
            server.create_initialization_options()
        )

if __name__ == "__main__":
    asyncio.run(main())
```

---

## ğŸ¯ é¡¹ç›®ç»“æ„

```
financial-report/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ mcp_server/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py
â”‚       â””â”€â”€ tools/
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ company_report_generator.py
â”œâ”€â”€ output/
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ setup.py
```

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### 1. å¯åŠ¨MCPæœåŠ¡å™¨

```bash
cd financial-report
python -m src.mcp_server.main
```

### 2. å®¢æˆ·ç«¯è°ƒç”¨

```python
import asyncio
from mcp.client.stdio import stdio_client

async def test_mcp_server():
    async with stdio_client() as (read_stream, write_stream):
        # åˆ—å‡ºå¯ç”¨å·¥å…·
        tools_response = await client.list_tools()
        print("å¯ç”¨å·¥å…·:", tools_response.tools)
        
        # ç”Ÿæˆè´¢æŠ¥
        report_response = await client.call_tool(
            name="generate_company_report",
            arguments={"symbol": "NVDA", "report_type": "annual"}
        )
        print("æŠ¥å‘Šå†…å®¹:", report_response.content)

if __name__ == "__main__":
    asyncio.run(test_mcp_server())
```

---

## ğŸ’¡ æŠ€æœ¯è¦ç‚¹

### 1. MCPåè®®è§„èŒƒ

- **å·¥å…·å®šä¹‰**ï¼šä½¿ç”¨JSON Schemaå®šä¹‰å·¥å…·è¾“å…¥è¾“å‡º
- **å¼‚æ­¥å¤„ç†**ï¼šæ‰€æœ‰å·¥å…·è°ƒç”¨éƒ½æ˜¯å¼‚æ­¥çš„
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶

### 2. æ•°æ®å®‰å…¨

- **è¾“å…¥éªŒè¯**ï¼šä¸¥æ ¼éªŒè¯ç”¨æˆ·è¾“å…¥
- **æ–‡ä»¶éš”ç¦»**ï¼šè¾“å‡ºæ–‡ä»¶ç‹¬ç«‹å­˜å‚¨
- **æƒé™æ§åˆ¶**ï¼šé™åˆ¶æ–‡ä»¶è®¿é—®æƒé™

### 3. æ‰©å±•æ€§è®¾è®¡

- **æ¨¡å—åŒ–**ï¼šå·¥å…·åŠŸèƒ½æ¨¡å—åŒ–è®¾è®¡
- **æ’ä»¶åŒ–**ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ æ–°å·¥å…·
- **é…ç½®åŒ–**ï¼šæ”¯æŒé…ç½®æ–‡ä»¶ç®¡ç†

---

## ğŸ¯ é¡¹ç›®æˆæœ

### æ ¸å¿ƒåŠŸèƒ½
1. **å…¬å¸åˆ—è¡¨ç®¡ç†**ï¼šæ”¯æŒ10å®¶çŸ¥åå…¬å¸
2. **è´¢æŠ¥ç”Ÿæˆ**ï¼šè‡ªåŠ¨ç”Ÿæˆè¯¦ç»†è´¢åŠ¡æŠ¥å‘Š
3. **å¤šæ ¼å¼è¾“å‡º**ï¼šæ”¯æŒMarkdownã€PDFç­‰æ ¼å¼
4. **å®æ—¶æ•°æ®**ï¼šé›†æˆå®æ—¶è´¢åŠ¡æ•°æ®

### æŠ€æœ¯ç‰¹è‰²
- **MCPæ ‡å‡†**ï¼šå®Œå…¨éµå¾ªMCPåè®®è§„èŒƒ
- **å¼‚æ­¥æ¶æ„**ï¼šé«˜æ€§èƒ½å¼‚æ­¥å¤„ç†
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **å®Œæ•´æ–‡æ¡£**ï¼šè¯¦ç»†çš„APIæ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜

---

## ğŸ”® æœªæ¥å±•æœ›

### åŠŸèƒ½æ‰©å±•
1. **æ›´å¤šå…¬å¸**ï¼šæ‰©å±•åˆ°æ›´å¤šä¸Šå¸‚å…¬å¸
2. **æ•°æ®åˆ†æ**ï¼šé›†æˆæ›´æ·±å…¥çš„è´¢åŠ¡åˆ†æ
3. **å¯è§†åŒ–**ï¼šæ·»åŠ å›¾è¡¨å’Œå¯è§†åŒ–åŠŸèƒ½
4. **å¤šè¯­è¨€**ï¼šæ”¯æŒå¤šè¯­è¨€æŠ¥å‘Šç”Ÿæˆ

### æŠ€æœ¯ä¼˜åŒ–
1. **æ€§èƒ½ä¼˜åŒ–**ï¼šæå‡ç”Ÿæˆé€Ÿåº¦
2. **ç¼“å­˜æœºåˆ¶**ï¼šæ·»åŠ æ•°æ®ç¼“å­˜
3. **åˆ†å¸ƒå¼**ï¼šæ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²
4. **ç›‘æ§å‘Šè­¦**ï¼šæ·»åŠ ç³»ç»Ÿç›‘æ§

---

## ğŸ’­ ä¸ªäººæ„Ÿæ‚Ÿ

é€šè¿‡è¿™ä¸ªMCPè´¢åŠ¡æŠ¥å‘Šç”Ÿæˆå·¥å…·çš„å¼€å‘ï¼Œæˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº†MCPåè®®çš„ä»·å€¼ï¼š

1. **æ ‡å‡†åŒ–**ï¼šMCPæä¾›äº†AIå·¥å…·çš„æ ‡å‡†æ¥å£
2. **äº’æ“ä½œæ€§**ï¼šä¸åŒAIæ¨¡å‹å¯ä»¥æ— ç¼ä½¿ç”¨åŒä¸€å·¥å…·
3. **å®‰å…¨æ€§**ï¼šç»“æ„åŒ–çš„äº¤äº’æ–¹å¼æé«˜äº†å®‰å…¨æ€§
4. **æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’Œå·¥å…·

MCPä¸ä»…æ˜¯ä¸€ä¸ªåè®®ï¼Œæ›´æ˜¯AIå·¥å…·ç”Ÿæ€çš„é‡è¦åŸºç¡€è®¾æ–½ã€‚å®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿæ„å»ºæ›´åŠ æ™ºèƒ½ã€å®‰å…¨ã€å¯æ‰©å±•çš„AIåº”ç”¨ã€‚

---

## ğŸ“ äº¤æµäº’åŠ¨

å¦‚æœä½ ä¹Ÿå¯¹MCPæŠ€æœ¯æ„Ÿå…´è¶£ï¼Œæ¬¢è¿ï¼š

1. **è®¿é—®é¡¹ç›®ä»“åº“**ï¼š[GitHubé¡¹ç›®åœ°å€](https://github.com/KennanYang/financial-report)
2. **æŸ¥çœ‹åœ¨çº¿æ¼”ç¤º**ï¼š[é¡¹ç›®æ¼”ç¤º](https://github.com/KennanYang/financial-report)
3. **åˆ†äº«ä½ çš„é¡¹ç›®**ï¼šä¸€èµ·æ¢è®¨MCPå¼€å‘çš„å¯èƒ½æ€§

---

## ğŸ¯ å†™åœ¨æœ€å

MCPæŠ€æœ¯ä¸ºAIå·¥å…·å¼€å‘å¸¦æ¥äº†æ–°çš„å¯èƒ½æ€§ã€‚é€šè¿‡æ ‡å‡†åŒ–çš„åè®®ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºæ›´åŠ æ™ºèƒ½ã€å®‰å…¨ã€å¯æ‰©å±•çš„AIåº”ç”¨ã€‚

è¿™ä¸ªè´¢åŠ¡æŠ¥å‘Šç”Ÿæˆå·¥å…·åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼ŒMCPçš„æ½œåŠ›è¿œä¸æ­¢äºæ­¤ã€‚æœŸå¾…çœ‹åˆ°æ›´å¤šåŸºäºMCPçš„åˆ›æ–°åº”ç”¨ï¼

**å…³æ³¨æˆ‘ï¼Œçœ‹ä¸€ä¸ªéå¤©æ‰è§£é¢˜è€…çš„AIå®æˆ˜å®å½•ï¼**

---

*æœ¬æ–‡ä¸ºæºå—AIå®æˆ˜æ´¾åŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚*
